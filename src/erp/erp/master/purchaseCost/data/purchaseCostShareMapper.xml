<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="erp.erp.master.purchaseCost.data.purchaseCostShareMapper">


<select id="getpurchaseCostShareList" parameterType="map" resultType="erp.erp.master.purchaseCost.model.purchaseCostShare">
	  SELECT cyjhmxb.cybh,   
         cyjhmxb.cyxh, 
		 ltrim(rtrim(cyjhmxb.cybh))+'-'+ltrim(rtrim(cyjhmxb.cyxh)) as cyh,
		 cyjhmxb.cpbh,   
         cyjhmxb.cptx1,          
         cyjhmxb.cptx2,              
         cyjhmxb.cptx3,   
         cyjhmxb.jldw,          
         cyjhmxb.hjtj,
		 cyjhb.xslb,
		 xslbb.lbmc as xslbmc,
		 cpbmb.cpmc,
		 cpbmb.plmth,
	     cpbmb.plmtx,
	     case when #{bj}=1 then
		    case when cyjh_wtsb.tjhj>0 then round((cyjhmxb.hjtj/cyjh_wtsb.tjhj) *#{fyje},2) else 0 end
		    else
			0 
			end as ftje,
		 case when isnull(xslbb.ysbbj,0)=1 then hsbmb.bmmc else cyjhmxb.qygc end as hsbm
		 
    FROM cyjhmxb with (nolock) 
	left outer join cyjhb with(nolock) on cyjhb.cybh=cyjhmxb.cybh
	left outer join cyjh_wtsb with(nolock) on cyjh_wtsb.cybh=cyjhmxb.cybh
	left outer join xslbb with (nolock) on xslbb.lbbh=cyjhb.xslb
	left outer join hsbmb with (nolock) on xslbb.hsbm=hsbmb.bmbh	
	left outer join cpbmb with(nolock) on cpbmb.cpbh=cyjhmxb.cpbh
	where cyjhmxb.cybh=#{cybh}
</select>
<insert id="addpurchaseCostShare" parameterType="erp.erp.master.purchaseCost.model.purchaseCostShare" keyProperty="" useGeneratedKeys="true">
	insert into dbo.cyjhmxb
	(
		cybh,
		cyxh,
		ddbh,
		ddxh,
		cpbh,
		cptx1,
		cptx2,
		cptx3,
		jldw,
		chxs,
		mxzs,
		chsl,
		sfsl,
		xtcd,
		xtkd,
		xtgd,
		mxtj,
		mxmz,
		mxjz,
		hjtj,
		hjmz,
		hjjz,
		bzsm,
		htbz,
		jhh,
		khxh,
		khhh,
		wbbh,
		cydj,
		cyje,
		zgfz,
		qygc,
		gdhm,
		psbj,
		pssj,
		psnr,
		psrm,
		psch,
		zzbh,
		zzxh,
		hsbm,
		bgywm,
		bgzwm,
		bgys,
		myfs,
		ywms,
		dydh,
		dyxh,
		pono,
		xgly,
		jzbj,
		jzrm,
		jzsj,
		tsl,
		cwpsbj,
		cwpssj,
		cwpsnr,
		cwpsrm,
		pstg,
		jzym,
		psgdbj,
		psgdrm,
		psgdsj,
		jsbj,
		jsrm,
		jssj,
		qdtg,
		psyh,
		ggzc,
		scbj,
		zzbj,
		zzrm,
		zzsj,
		bzbh,
		bzxh,
		cfbh,
		cfxh,
		drpycbj,
		bzlx,
		bsbj
	)
	values
	(
		#{cybh},
		#{cyxh},
		#{ddbh},
		#{ddxh},
		#{cpbh},
		#{cptx1},
		#{cptx2},
		#{cptx3},
		#{jldw},
		#{chxs},
		#{mxzs},
		#{chsl},
		#{sfsl},
		#{xtcd},
		#{xtkd},
		#{xtgd},
		#{mxtj},
		#{mxmz},
		#{mxjz},
		#{hjtj},
		#{hjmz},
		#{hjjz},
		#{bzsm},
		#{htbz},
		#{jhh},
		#{khxh},
		#{khhh},
		#{wbbh},
		#{cydj},
		#{cyje},
		#{zgfz},
		#{qygc},
		#{gdhm},
		#{psbj},
		#{pssj},
		#{psnr},
		#{psrm},
		#{psch},
		#{zzbh},
		#{zzxh},
		#{hsbm},
		#{bgywm},
		#{bgzwm},
		#{bgys},
		#{myfs},
		#{ywms},
		#{dydh},
		#{dyxh},
		#{pono},
		#{xgly},
		#{jzbj},
		#{jzrm},
		#{jzsj},
		#{tsl},
		#{cwpsbj},
		#{cwpssj},
		#{cwpsnr},
		#{cwpsrm},
		#{pstg},
		#{jzym},
		#{psgdbj},
		#{psgdrm},
		#{psgdsj},
		#{jsbj},
		#{jsrm},
		#{jssj},
		#{qdtg},
		#{psyh},
		#{ggzc},
		#{scbj},
		#{zzbj},
		#{zzrm},
		#{zzsj},
		#{bzbh},
		#{bzxh},
		#{cfbh},
		#{cfxh},
		#{drpycbj},
		#{bzlx},
		#{bsbj}
	)
</insert>
<update id="updatepurchaseCostShare" parameterType="erp.erp.master.purchaseCost.model.purchaseCostShare">
	update dbo.cyjhmxb
		set
			cybh = #{cybh},
			cyxh = #{cyxh},
			ddbh = #{ddbh},
			ddxh = #{ddxh},
			cpbh = #{cpbh},
			cptx1 = #{cptx1},
			cptx2 = #{cptx2},
			cptx3 = #{cptx3},
			jldw = #{jldw},
			chxs = #{chxs},
			mxzs = #{mxzs},
			chsl = #{chsl},
			sfsl = #{sfsl},
			xtcd = #{xtcd},
			xtkd = #{xtkd},
			xtgd = #{xtgd},
			mxtj = #{mxtj},
			mxmz = #{mxmz},
			mxjz = #{mxjz},
			hjtj = #{hjtj},
			hjmz = #{hjmz},
			hjjz = #{hjjz},
			bzsm = #{bzsm},
			htbz = #{htbz},
			jhh = #{jhh},
			khxh = #{khxh},
			khhh = #{khhh},
			wbbh = #{wbbh},
			cydj = #{cydj},
			cyje = #{cyje},
			zgfz = #{zgfz},
			qygc = #{qygc},
			gdhm = #{gdhm},
			psbj = #{psbj},
			pssj = #{pssj},
			psnr = #{psnr},
			psrm = #{psrm},
			psch = #{psch},
			zzbh = #{zzbh},
			zzxh = #{zzxh},
			hsbm = #{hsbm},
			bgywm = #{bgywm},
			bgzwm = #{bgzwm},
			bgys = #{bgys},
			myfs = #{myfs},
			ywms = #{ywms},
			dydh = #{dydh},
			dyxh = #{dyxh},
			pono = #{pono},
			xgly = #{xgly},
			jzbj = #{jzbj},
			jzrm = #{jzrm},
			jzsj = #{jzsj},
			tsl = #{tsl},
			cwpsbj = #{cwpsbj},
			cwpssj = #{cwpssj},
			cwpsnr = #{cwpsnr},
			cwpsrm = #{cwpsrm},
			pstg = #{pstg},
			jzym = #{jzym},
			psgdbj = #{psgdbj},
			psgdrm = #{psgdrm},
			psgdsj = #{psgdsj},
			jsbj = #{jsbj},
			jsrm = #{jsrm},
			jssj = #{jssj},
			qdtg = #{qdtg},
			psyh = #{psyh},
			ggzc = #{ggzc},
			scbj = #{scbj},
			zzbj = #{zzbj},
			zzrm = #{zzrm},
			zzsj = #{zzsj},
			bzbh = #{bzbh},
			bzxh = #{bzxh},
			cfbh = #{cfbh},
			cfxh = #{cfxh},
			drpycbj = #{drpycbj},
			bzlx = #{bzlx},
			bsbj = #{bsbj}
		where  = #{}
</update>
<delete id="deletepurchaseCostShare" parameterType="erp.erp.master.purchaseCost.model.purchaseCostShare">
	delete from dbo.cyjhmxb
	where  = #{}
</delete>
</mapper>
