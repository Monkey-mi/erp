<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="erp.erp.PayApply.data.CgfyMapper">


<select id="getCgfyList" parameterType="map" resultType="erp.erp.PayApply.model.Cgfy">
	 SELECT  cgfyb.fydh,
			cgfyb.fyxh,
			cgfyb.fyrq,
			cgfyb.yhbh,
			cgfyb.cglb,
			cgfyb.csbh,  
			cgfyb.fyzy,
			cgfyb.fysl,
			cgfyb.fydj,
			cgfyb.fyje,
			cgfyb.zzsl,
			cgfyb.csdj,
			cgfyb.csje,
         cgfyb.fyje -  cgfyb.csje as zzse,
			cgfyb.jhbh,
			cgfyb.jhxh,
         case when cgfyb.jhbh&lt;&gt;0 then
            ltrim(rtrim(str(cgfyb.jhbh)))+'-'+ltrim(rtrim(str(cgfyb.jhxh))) end as jhh,
			cgfyb.htbh,
			cgfyb.htxh,
         case when cgfyb.htbh&lt;&gt;0 then
            ltrim(rtrim(str(cgfyb.htbh)))+'-'+ltrim(rtrim(str(cgfyb.htxh))) end as hth,
			cgfyb.bzsm,
			cgfyb.hxbj,
			cgfyb.fplb,
			cgfyb.fphm,
			cgfyb.sdbj,
			cgfyb.sdrm,
			cgfyb.sdsj,
			cgfyb.czym,
			cgfyb.czsj,
			cgfyb.tzdh,
			csxxb.csmc,
			cgfyb.hsdh,
			cgfyb.hsxh,
			cgfyb.hsbm,
			cgfyb.spbj,
			cgfyb.sprm,
			cgfyb.spyj,
			cgfyb.spsj,
			cgfyb.tjbj,
			cgfyb.tjrm,
			cgfyb.tjsj,
			cgfyb.tjdx,
			cgfyb.fylx,
			cgfyb.cybh,	
 			case when cgfyb.hsdh&lt;&gt;0 then
            ltrim(rtrim(str(cgfyb.hsdh)))+'-'+ltrim(rtrim(str(cgfyb.hsxh))) end as hsh,
			cgfyb.fpdx,
			cgfyb.fyxz,
			cgfyb.wbbh,
			cgfyb.wbhl,
			cgfyb.wbje,
         cgfyb.wxdh,
			cgfyb.wxxh,
         case when cgfyb.wxdh&lt;&gt;0 then
            ltrim(rtrim(str(cgfyb.wxdh)))+'-'+ltrim(rtrim(str(cgfyb.wxxh))) end as wxh
    FROM cgfyb
left outer join fksqspfyb with (nolock)  on cgfyb.fydh=fksqspfyb.fydh and  cgfyb.fyxh=fksqspfyb.fyxh 
left outer join csxxb with (nolock)  on csxxb.csbh=cgfyb.csbh
where fksqspfyb.sqbh=#{sqbh} 

union all

 SELECT  cgfyb.fydh,
			cgfyb.fyxh,
			cgfyb.fyrq,
			cgfyb.yhbh,
			cgfyb.cglb,
			cgfyb.csbh, 
			cgfyb.fyzy,
			cgfyb.fysl,
			cgfyb.fydj,
			cgfyb.fyje,
			cgfyb.zzsl,
			cgfyb.csdj,
			cgfyb.csje,
         cgfyb.fyje -  cgfyb.csje as zzse,
			cgfyb.jhbh,
			cgfyb.jhxh,
         case when cgfyb.jhbh&lt;&gt;0 then
            ltrim(rtrim(str(cgfyb.jhbh)))+'-'+ltrim(rtrim(str(cgfyb.jhxh))) end as jhh,
			cgfyb.htbh,
			cgfyb.htxh,
         case when cgfyb.htbh&lt;&gt;0 then
            ltrim(rtrim(str(cgfyb.htbh)))+'-'+ltrim(rtrim(str(cgfyb.htxh))) end as hth,
			cgfyb.bzsm,
			cgfyb.hxbj,
			cgfyb.fplb,
			cgfyb.fphm,
			cgfyb.sdbj,
			cgfyb.sdrm,
			cgfyb.sdsj,
			cgfyb.czym,
			cgfyb.czsj,
			cgfyb.tzdh,
			csxxb.csmc,
			cgfyb.hsdh,
			cgfyb.hsxh,
			cgfyb.hsbm,
			cgfyb.spbj,
			cgfyb.sprm,
			cgfyb.spyj,
			cgfyb.spsj,
			cgfyb.tjbj,
			cgfyb.tjrm,
			cgfyb.tjsj,
			cgfyb.tjdx,
			cgfyb.fylx,
			cgfyb.cybh,	
 			case when cgfyb.hsdh&lt;&gt;0 then
            ltrim(rtrim(str(cgfyb.hsdh)))+'-'+ltrim(rtrim(str(cgfyb.hsxh))) end as hsh,
			cgfyb.fpdx,
			cgfyb.fyxz,
			cgfyb.wbbh,
			cgfyb.wbhl,
			cgfyb.wbje,
         cgfyb.wxdh,
			cgfyb.wxxh,
         case when cgfyb.wxdh&lt;&gt;0 then
            ltrim(rtrim(str(cgfyb.wxdh)))+'-'+ltrim(rtrim(str(cgfyb.wxxh))) end as wxh
    FROM cgfyb
left outer join fksqspfyb with (nolock)  on cgfyb.fydh=fksqspfyb.fydh and  cgfyb.fyxh=fksqspfyb.fyxh 
left outer join csxxb with (nolock)  on csxxb.csbh=cgfyb.csbh
inner join fksqspmxb with (nolock) on fksqspmxb.fplb=cgfyb.fplb and fksqspmxb.fphm=cgfyb.fphm and fksqspmxb.sqbh=#{sqbh} 
</select>
<insert id="addCgfy" parameterType="erp.erp.PayApply.model.Cgfy" keyProperty="" useGeneratedKeys="true">
	insert into Cgfy
	(
		fydh,
		fyxh,
		fyrq,
		yhbh,
		cglb,
		csbh,
		fyzy,
		fysl,
		fydj,
		fyje,
		zzsl,
		csdj,
		csje,
		zzse,
		jhbh,
		jhxh,
		jhh,
		htbh,
		htxh,
		hth,
		bzsm,
		hxbj,
		fplb,
		fphm,
		sdbj,
		sdrm,
		sdsj,
		czym,
		czsj,
		tzdh,
		csmc,
		hsdh,
		hsxh,
		hsbm,
		spbj,
		sprm,
		spyj,
		spsj,
		tjbj,
		tjrm,
		tjsj,
		tjdx,
		fylx,
		cybh,
		hsh,
		fpdx,
		fyxz,
		wbbh,
		wbhl,
		wbje,
		wxdh,
		wxxh,
		wxh
	)
	values
	(
		#{fydh},
		#{fyxh},
		#{fyrq},
		#{yhbh},
		#{cglb},
		#{csbh},
		#{fyzy},
		#{fysl},
		#{fydj},
		#{fyje},
		#{zzsl},
		#{csdj},
		#{csje},
		#{zzse},
		#{jhbh},
		#{jhxh},
		#{jhh},
		#{htbh},
		#{htxh},
		#{hth},
		#{bzsm},
		#{hxbj},
		#{fplb},
		#{fphm},
		#{sdbj},
		#{sdrm},
		#{sdsj},
		#{czym},
		#{czsj},
		#{tzdh},
		#{csmc},
		#{hsdh},
		#{hsxh},
		#{hsbm},
		#{spbj},
		#{sprm},
		#{spyj},
		#{spsj},
		#{tjbj},
		#{tjrm},
		#{tjsj},
		#{tjdx},
		#{fylx},
		#{cybh},
		#{hsh},
		#{fpdx},
		#{fyxz},
		#{wbbh},
		#{wbhl},
		#{wbje},
		#{wxdh},
		#{wxxh},
		#{wxh}
	)
</insert>
<update id="updateCgfy" parameterType="erp.erp.PayApply.model.Cgfy">
	update Cgfy
		set
			fydh = #{fydh},
			fyxh = #{fyxh},
			fyrq = #{fyrq},
			yhbh = #{yhbh},
			cglb = #{cglb},
			csbh = #{csbh},
			fyzy = #{fyzy},
			fysl = #{fysl},
			fydj = #{fydj},
			fyje = #{fyje},
			zzsl = #{zzsl},
			csdj = #{csdj},
			csje = #{csje},
			zzse = #{zzse},
			jhbh = #{jhbh},
			jhxh = #{jhxh},
			jhh = #{jhh},
			htbh = #{htbh},
			htxh = #{htxh},
			hth = #{hth},
			bzsm = #{bzsm},
			hxbj = #{hxbj},
			fplb = #{fplb},
			fphm = #{fphm},
			sdbj = #{sdbj},
			sdrm = #{sdrm},
			sdsj = #{sdsj},
			czym = #{czym},
			czsj = #{czsj},
			tzdh = #{tzdh},
			csmc = #{csmc},
			hsdh = #{hsdh},
			hsxh = #{hsxh},
			hsbm = #{hsbm},
			spbj = #{spbj},
			sprm = #{sprm},
			spyj = #{spyj},
			spsj = #{spsj},
			tjbj = #{tjbj},
			tjrm = #{tjrm},
			tjsj = #{tjsj},
			tjdx = #{tjdx},
			fylx = #{fylx},
			cybh = #{cybh},
			hsh = #{hsh},
			fpdx = #{fpdx},
			fyxz = #{fyxz},
			wbbh = #{wbbh},
			wbhl = #{wbhl},
			wbje = #{wbje},
			wxdh = #{wxdh},
			wxxh = #{wxxh},
			wxh = #{wxh}
		where  = #{}
</update>
<delete id="deleteCgfy" parameterType="erp.erp.PayApply.model.Cgfy">
	delete from Cgfy
	where  = #{}
</delete>
</mapper>
